% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/map_tools.R
\name{map_create}
\alias{map_create}
\title{Create a Prediction Map in Google Earth Engine Using a Fitted Random Forest Model}
\usage{
map_create(
  model,
  stack,
  aoi = NULL,
  reducer = c("mosaic", "median"),
  mode = c("auto", "classifier"),
  to_float = TRUE
)
}
\arguments{
\item{model}{A fitted \code{randomForest::randomForest} model, or a wrapper
object containing an element named \code{model}.}

\item{stack}{An \code{ee$Image} or \code{ee$ImageCollection} providing the
predictor variables (bands) matching those used to train the model.}

\item{aoi}{Optional EE geometry. If provided, the output map is clipped to it.}

\item{reducer}{Aggregation method when \code{stack} is an image collection.
One of: \code{"mosaic"} (default) or \code{"median"}.}

\item{mode}{Controls how the estimator is applied. Currently supported:
\itemize{
\item \code{"auto"}       — (default) applies the classifier with
\code{img$classify()}.
\item \code{"classifier"} — explicitly applies \code{img$classify()}.
}
The \code{"regressor"} option is not supported, as the current
implementation only builds an Earth Engine classifier.}

\item{to_float}{Logical; if \code{TRUE} (default) converts the output band to
32-bit float.}
}
\value{
An Earth Engine \code{ee$Image} containing model predictions.
}
\description{
Applies a fitted Random Forest model (from R's \code{randomForest} package)
to a Google Earth Engine (\strong{EE}) image or image collection and returns
an EE image containing predicted values.

The model is converted to an Earth Engine estimator using
\code{\link{build_ee_forest}}, which internally serializes the R forest
through the ICESat2VegR C++ module (\code{icesat2_module}) and constructs an
EE \code{Classifier} via \code{ee$Classifier$decisionTreeEnsemble()}.
}
\details{
This function works for both:
\itemize{
\item EE images: predictors already merged into one raster.
\item EE image collections: predictions computed for each image and reduced
using mosaic or median.
}

The output band is always named \code{"prediction_layer"}.

Properties from a zero-pixel placeholder image are copied to preserve band
metadata.
}
\examples{
\dontrun{
  library(ICESat2VegR)
  library(randomForest)

  # Fit a model in R
  data(airquality)
  air <- na.omit(airquality)

  rf_model <- randomForest(
    x = air[, 2:6],
    y = air[, 1],
    ntree = 100,
    importance = TRUE
  )

  # Suppose 'stack_ee' is an Earth Engine image with matching bands
  pred <- map_create(
    model = rf_model,
    stack = stack_ee,
    aoi   = NULL,
    mode  = "auto"
  )

  # Now pred is: ee$Image with one band ("prediction_layer")
}

}
\seealso{
\code{\link{build_ee_forest}}
\code{randomForest::randomForest}
Earth Engine API reference: \url{https://developers.google.com/earth-engine}
}
